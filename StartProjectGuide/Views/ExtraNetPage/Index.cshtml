@using System.Web.Providers.Entities
@using EPiServer.Core
@using EPiServer.Filters
@using EPiServer.Security
@using StartProjectGuide.Business.Extensions
@using EPiServer.Web.Mvc.Html
@using StartProjectGuide
@using StartProjectGuide.Business
@using StartProjectGuide.Business.DynamicDataStore

@model  StartProjectGuide.Business.Interfaces.IPageViewModel<StartProjectGuide.Models.Pages.ExtraNetPage>
@{
    var weatherEntries = WeatherDds.GetWeatherEntries(this.Model.CurrentPage.ContentLink);
    WeatherDds.Weather w = new WeatherDds.Weather();
}
@if (User.Identity.IsAuthenticated)
{
    <div>
        @if (User.IsAdmin())
        {
            @Html.PropertyFor(m => m.CurrentPage.ForAdmin)
        }
        @Html.PropertyFor(m => m.CurrentPage.ForUsers)
    </div>
    
    <form method="get" name="search">
        <input type="text" tabindex="1" name="q" value="" />
        <input type="submit" tabindex="2" class="btn" value="Search" />
    </form>
    <span>Weather</span>
    <form action="" name="">

    </form>
}
@if (User.IsAdmin())
{
    <div>
        @foreach (var entry in weatherEntries)
        {
            <span>@entry.TimeStamp</span>
            <span>@entry.WeatherDescription</span>
            <span>@entry.WeatherComment</span>
        }
    </div>
}